# Azure Deployment â€” UI Guide (Demo Setup)

> This is a one-time manual upload for a demo. No pipelines needed.

---

## What You'll Deploy

| # | App | Build Folder | Azure Service |
|---|---|---|---|
| 1 | **Backend API** | `backend/` | Azure Web App (Python) |
| 2 | **Decision App** | `decision-app/dist/` | Azure Blob Storage (Static Website) |
| 3 | **Landing Page** | `dist/` | Azure Blob Storage (Static Website) |

---

## Step 1 â€” Create a Resource Group

1. Go to [portal.azure.com](https://portal.azure.com) â†’ search **"Resource groups"**
2. Click **+ Create**
3. Name: `ai-conclave-rg` Â· Region: any (e.g. East US)
4. Click **Review + Create â†’ Create**

---

## Step 2 â€” Deploy the Backend (Azure Web App)

### 2.1 â€” Create the Web App
1. Search **"App Services"** â†’ **+ Create â†’ Web App**
2. Fill in:

   | Field | Value |
   |---|---|
   | Resource Group | `ai-conclave-rg` |
   | Name | `ai-conclave-api` *(globally unique)* |
   | Publish | Code |
   | Runtime stack | **Python 3.11** |
   | OS | Linux |
   | Plan | **Free F1** (fine for 50 users) |

3. Click **Review + Create â†’ Create**

### 2.2 â€” Set Startup Command
1. Open the Web App â†’ left menu â†’ **Configuration â†’ General settings**
2. Set **Startup Command**:
   ```
   gunicorn -w 4 -k uvicorn.workers.UvicornWorker main:app --bind 0.0.0.0:8000
   ```
3. Click **Save**

### 2.3 â€” Upload Backend Code via Portal
1. Open the Web App â†’ left menu â†’ **Development Tools â†’ Advanced Tools (Kudu)** â†’ click **Go â†’**
2. In Kudu: top menu â†’ **Tools â†’ Zip Push Deploy**
3. Zip your `backend/` folder contents *(not the folder itself â€” select all files inside)*
4. Drag & drop the ZIP onto the Kudu page

> **Note:** Exclude `myenv/` and `__pycache__/` from the zip â€” only include your [.py](file:///c:/Users/madhu/Desktop/ai-cloncave/backend/main.py) files, [requirements.txt](file:///c:/Users/madhu/Desktop/ai-cloncave/backend/requirements.txt), and `routers/`, [ml/](file:///c:/Users/madhu/Desktop/ai-cloncave/index.html) folders.

### 2.4 â€” Note your Backend URL
```
https://ai-conclave-api.azurewebsites.net
```
Visit it â€” you should see `{"message": "Underwriting Intelligence API is running"}`

---

## Step 3 â€” Build & Deploy Decision App

### 3.1 â€” Update [.env](file:///c:/Users/madhu/Desktop/ai-cloncave/.env) and build locally
Edit [decision-app/.env](file:///c:/Users/madhu/Desktop/ai-cloncave/decision-app/.env):
```env
VITE_API_BASE_URL=https://ai-conclave-api.azurewebsites.net
```
Then build:
```bash
cd decision-app
npm install
npm run build
```
Output is in `decision-app/dist/`

### 3.2 â€” Create Storage Account in Portal
1. Search **"Storage accounts"** â†’ **+ Create**
2. Fill in:

   | Field | Value |
   |---|---|
   | Resource Group | `ai-conclave-rg` |
   | Name | `aiconclavedecision` *(lowercase, unique)* |
   | Region | Same as above |
   | Redundancy | LRS |

3. Click **Review + Create â†’ Create**

### 3.3 â€” Enable Static Website
1. Open the storage account â†’ left menu â†’ **Data Management â†’ Static website**
2. Toggle **Enabled**
3. Index document: [index.html](file:///c:/Users/madhu/Desktop/ai-cloncave/index.html) Â· Error document: [index.html](file:///c:/Users/madhu/Desktop/ai-cloncave/index.html)
4. Click **Save**
5. **Copy the Primary endpoint** (e.g. `https://aiconclavedecision.z13.web.core.windows.net`) â€” save this!

### 3.4 â€” Upload the Build Files
1. Left menu â†’ **Data storage â†’ Containers** â†’ click **`$web`**
2. Click **Upload** â†’ select **all files inside** `decision-app/dist/`
   - âš ï¸ Also upload the `assets/` subfolder â€” click **Advanced** â†’ tick **"Upload to folder"** and type `assets` for the assets folder
3. For the correct structure, upload in two passes:
   - Upload root files ([index.html](file:///c:/Users/madhu/Desktop/ai-cloncave/index.html), etc.) directly
   - Upload `assets/` folder contents with folder path `assets`

> **Easier way:** Use [Azure Storage Explorer](https://azure.microsoft.com/en-us/products/storage/storage-explorer/) (free desktop app) â†’ drag & drop the entire `dist/` folder into `$web`

---

## Step 4 â€” Build & Deploy Landing Page

### 4.1 â€” Update [.env](file:///c:/Users/madhu/Desktop/ai-cloncave/.env) and build locally
Edit [c:\Users\madhu\Desktop\ai-cloncave\.env](file:///c:/Users/madhu/Desktop/ai-cloncave/.env):
```env
VITE_API_BASE_URL=https://ai-conclave-api.azurewebsites.net
VITE_DECISION_APP_URL=https://aiconclavedecision.z13.web.core.windows.net
```
Then build:
```bash
cd c:\Users\madhu\Desktop\ai-cloncave
npm install
npm run build
```
Output is in `dist/`

### 4.2 â€” Create Storage Account for Landing Page
Repeat Step 3.2 with name: `aiconclavelanding`

### 4.3 â€” Enable Static Website
Repeat Step 3.3 for `aiconclavelanding`

### 4.4 â€” Upload Build Files
Same as Step 3.4 â€” upload contents of `dist/` into the `$web` container.

> Use **Azure Storage Explorer** for easiest drag & drop upload.

---

## Step 5 â€” Update Backend CORS

1. Open [backend/main.py](file:///c:/Users/madhu/Desktop/ai-cloncave/backend/main.py) and update:
   ```python
   allow_origins=[
       "https://aiconclavedecision.z13.web.core.windows.net",
       "https://aiconclavelanding.z13.web.core.windows.net",
   ],
   ```
2. Re-zip and re-upload the backend (repeat Step 2.3)

---

## Final URLs

| Service | URL |
|---|---|
| ðŸŒ Landing Page | `https://aiconclavelanding.z13.web.core.windows.net` |
| ðŸ“± Decision App (QR) | `https://aiconclavedecision.z13.web.core.windows.net` |
| âš™ï¸ Backend API | `https://ai-conclave-api.azurewebsites.net` |

> [!TIP]
> **Azure Storage Explorer** (free desktop app) makes uploading the `dist/` folders much easier than the Portal UI. [Download here](https://azure.microsoft.com/en-us/products/storage/storage-explorer/)
